{"episode_reward_max": -1022.6022794297251, "episode_reward_min": -2566.5267241532324, "episode_reward_mean": -1584.1713665976995, "episode_len_mean": 400.0, "episodes_this_iter": 63, "policy_reward_mean": {"av": -21.767240151724046}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-06, "total_loss": 904.4575805664062, "policy_loss": 20.757524490356445, "vf_loss": 883.6976318359375, "vf_explained_var": 1.4781951904296875e-05, "kl": 1.0283788469678257e-05, "entropy": 1.4237251281738281}, "num_steps_trained": 25800, "num_steps_sampled": 25800, "sample_time_ms": 261173.147, "grad_time_ms": 18798.881, "update_time_ms": 139.855, "opt_peak_throughput": 1372.422, "sample_peak_throughput": 98.785, "opt_samples": 25800.0, "learner": {}}, "timesteps_this_iter": 25800, "done": false, "timesteps_total": 25800, "episodes_total": 63, "experiment_id": "675601f1efb241099ba7ab80b441289a", "date": "2019-10-10_16-39-17", "timestamp": 1570739957, "training_iteration": 1, "time_this_iter_s": 280.23417592048645, "time_total_s": 280.23417592048645, "pid": 28214, "hostname": "node-050", "node_ip": "172.31.2.35", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"discrete\": false,\n            \"fraction_av\": 0.5,\n            \"inflow_base\": 803,\n            \"inflow_delta\": 20,\n            \"max_accel\": 3.5,\n            \"max_decel\": 5,\n            \"num_observed\": 2,\n            \"reset_inflow\": true,\n            \"speed_enter\": 30,\n            \"switch_time\": 3,\n            \"target_velocity\": 35,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiGridAVsPOEnv\",\n    \"exp_tag\": \"grid_av_0_1x1_i803_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"random\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 0,\n                \"cars_left\": 0,\n                \"cars_right\": 0,\n                \"cars_top\": 0,\n                \"col_num\": 1,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 1,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"traffic_lights\": false,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"followerstopper\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"followerstopper\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 3.5,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 3.5,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"followerstopper\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiGridAVsPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 3, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 25600, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(38,)", "Box(1,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x15183e71e470>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 1e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 280.23417592048645, "timesteps_since_restore": 25800, "iterations_since_restore": 1}
{"episode_reward_max": -518.0192070870767, "episode_reward_min": -2591.8434555626154, "episode_reward_mean": -1576.557658970004, "episode_len_mean": 398.36, "episodes_this_iter": 66, "policy_reward_mean": {"av": -21.730636236664367}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-06, "total_loss": 943.3734741210938, "policy_loss": 20.9898681640625, "vf_loss": 922.3819580078125, "vf_explained_var": 1.3172626495361328e-05, "kl": 6.658043730567442e-06, "entropy": 1.4243650436401367}, "num_steps_trained": 51600, "num_steps_sampled": 51600, "sample_time_ms": 262997.768, "grad_time_ms": 18449.745, "update_time_ms": 72.196, "opt_peak_throughput": 1398.393, "sample_peak_throughput": 98.1, "opt_samples": 25800.0, "learner": {}}, "timesteps_this_iter": 25800, "done": false, "timesteps_total": 51600, "episodes_total": 129, "experiment_id": "675601f1efb241099ba7ab80b441289a", "date": "2019-10-10_16-44-00", "timestamp": 1570740240, "training_iteration": 2, "time_this_iter_s": 283.0429618358612, "time_total_s": 563.2771377563477, "pid": 28214, "hostname": "node-050", "node_ip": "172.31.2.35", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"discrete\": false,\n            \"fraction_av\": 0.5,\n            \"inflow_base\": 803,\n            \"inflow_delta\": 20,\n            \"max_accel\": 3.5,\n            \"max_decel\": 5,\n            \"num_observed\": 2,\n            \"reset_inflow\": true,\n            \"speed_enter\": 30,\n            \"switch_time\": 3,\n            \"target_velocity\": 35,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiGridAVsPOEnv\",\n    \"exp_tag\": \"grid_av_0_1x1_i803_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"random\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 0,\n                \"cars_left\": 0,\n                \"cars_right\": 0,\n                \"cars_top\": 0,\n                \"col_num\": 1,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 1,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"traffic_lights\": false,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"followerstopper\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"followerstopper\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 3.5,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 3.5,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"followerstopper\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiGridAVsPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 3, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 25600, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(38,)", "Box(1,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x15183e71edd8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 1e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 563.2771377563477, "timesteps_since_restore": 51600, "iterations_since_restore": 2}
{"episode_reward_max": -518.0192070870767, "episode_reward_min": -2648.7753342640945, "episode_reward_mean": -1561.7790959425943, "episode_len_mean": 398.36, "episodes_this_iter": 63, "policy_reward_mean": {"av": -21.467753896118076}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-06, "total_loss": 877.7642211914062, "policy_loss": 19.847814559936523, "vf_loss": 857.91064453125, "vf_explained_var": 1.9311904907226562e-05, "kl": 1.2692681593762245e-05, "entropy": 1.4255788326263428}, "num_steps_trained": 77400, "num_steps_sampled": 77400, "sample_time_ms": 265442.382, "grad_time_ms": 18231.58, "update_time_ms": 49.596, "opt_peak_throughput": 1415.127, "sample_peak_throughput": 97.196, "opt_samples": 25800.0, "learner": {}}, "timesteps_this_iter": 25800, "done": false, "timesteps_total": 77400, "episodes_total": 192, "experiment_id": "675601f1efb241099ba7ab80b441289a", "date": "2019-10-10_16-48-48", "timestamp": 1570740528, "training_iteration": 3, "time_this_iter_s": 288.2345218658447, "time_total_s": 851.5116596221924, "pid": 28214, "hostname": "node-050", "node_ip": "172.31.2.35", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"discrete\": false,\n            \"fraction_av\": 0.5,\n            \"inflow_base\": 803,\n            \"inflow_delta\": 20,\n            \"max_accel\": 3.5,\n            \"max_decel\": 5,\n            \"num_observed\": 2,\n            \"reset_inflow\": true,\n            \"speed_enter\": 30,\n            \"switch_time\": 3,\n            \"target_velocity\": 35,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiGridAVsPOEnv\",\n    \"exp_tag\": \"grid_av_0_1x1_i803_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"random\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 0,\n                \"cars_left\": 0,\n                \"cars_right\": 0,\n                \"cars_top\": 0,\n                \"col_num\": 1,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 1,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"traffic_lights\": false,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"followerstopper\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"followerstopper\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 3.5,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 3.5,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"followerstopper\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiGridAVsPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 3, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 25600, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(38,)", "Box(1,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x15183dab26a0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 1e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 851.5116596221924, "timesteps_since_restore": 77400, "iterations_since_restore": 3}
{"episode_reward_max": -1013.0884543620565, "episode_reward_min": -2636.4458635561186, "episode_reward_mean": -1509.2799025886006, "episode_len_mean": 399.74, "episodes_this_iter": 66, "policy_reward_mean": {"av": -20.63549224211917}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 9.999999747378752e-06, "total_loss": 724.129638671875, "policy_loss": 18.2027645111084, "vf_loss": 705.9238891601562, "vf_explained_var": 2.1278858184814453e-05, "kl": 6.3996758399298415e-06, "entropy": 1.4247320890426636}, "num_steps_trained": 103200, "num_steps_sampled": 103200, "sample_time_ms": 266777.91, "grad_time_ms": 18023.259, "update_time_ms": 38.697, "opt_peak_throughput": 1431.484, "sample_peak_throughput": 96.71, "opt_samples": 25800.0, "learner": {}}, "timesteps_this_iter": 25800, "done": false, "timesteps_total": 103200, "episodes_total": 258, "experiment_id": "675601f1efb241099ba7ab80b441289a", "date": "2019-10-10_16-53-37", "timestamp": 1570740817, "training_iteration": 4, "time_this_iter_s": 288.2746675014496, "time_total_s": 1139.786327123642, "pid": 28214, "hostname": "node-050", "node_ip": "172.31.2.35", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"discrete\": false,\n            \"fraction_av\": 0.5,\n            \"inflow_base\": 803,\n            \"inflow_delta\": 20,\n            \"max_accel\": 3.5,\n            \"max_decel\": 5,\n            \"num_observed\": 2,\n            \"reset_inflow\": true,\n            \"speed_enter\": 30,\n            \"switch_time\": 3,\n            \"target_velocity\": 35,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiGridAVsPOEnv\",\n    \"exp_tag\": \"grid_av_0_1x1_i803_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"random\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 0,\n                \"cars_left\": 0,\n                \"cars_right\": 0,\n                \"cars_top\": 0,\n                \"col_num\": 1,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 1,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"traffic_lights\": false,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"followerstopper\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"followerstopper\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 3.5,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 3.5,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"followerstopper\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiGridAVsPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 3, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 25600, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(38,)", "Box(1,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x15183e71e7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 1e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 1139.786327123642, "timesteps_since_restore": 103200, "iterations_since_restore": 4}
{"episode_reward_max": -887.1581805920927, "episode_reward_min": -2796.396800958172, "episode_reward_mean": -1504.9143339364455, "episode_len_mean": 399.74, "episodes_this_iter": 63, "policy_reward_mean": {"av": -20.592697508708827}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 9.999999747378752e-06, "total_loss": 774.2559814453125, "policy_loss": 19.109981536865234, "vf_loss": 755.143798828125, "vf_explained_var": 2.8014183044433594e-05, "kl": 2.7778387448051944e-06, "entropy": 1.424318552017212}, "num_steps_trained": 129000, "num_steps_sampled": 129000, "sample_time_ms": 267133.616, "grad_time_ms": 17981.731, "update_time_ms": 33.681, "opt_peak_throughput": 1434.79, "sample_peak_throughput": 96.581, "opt_samples": 25800.0, "learner": {}}, "timesteps_this_iter": 25800, "done": false, "timesteps_total": 129000, "episodes_total": 321, "experiment_id": "675601f1efb241099ba7ab80b441289a", "date": "2019-10-10_16-58-23", "timestamp": 1570741103, "training_iteration": 5, "time_this_iter_s": 286.44839882850647, "time_total_s": 1426.2347259521484, "pid": 28214, "hostname": "node-050", "node_ip": "172.31.2.35", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"discrete\": false,\n            \"fraction_av\": 0.5,\n            \"inflow_base\": 803,\n            \"inflow_delta\": 20,\n            \"max_accel\": 3.5,\n            \"max_decel\": 5,\n            \"num_observed\": 2,\n            \"reset_inflow\": true,\n            \"speed_enter\": 30,\n            \"switch_time\": 3,\n            \"target_velocity\": 35,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiGridAVsPOEnv\",\n    \"exp_tag\": \"grid_av_0_1x1_i803_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"random\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 0,\n                \"cars_left\": 0,\n                \"cars_right\": 0,\n                \"cars_top\": 0,\n                \"col_num\": 1,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 1,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"traffic_lights\": false,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"followerstopper\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"followerstopper\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 3.5,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 3.5,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"followerstopper\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiGridAVsPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 3, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 25600, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(38,)", "Box(1,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x15183dab2128>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 1e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 1426.2347259521484, "timesteps_since_restore": 129000, "iterations_since_restore": 5}
{"episode_reward_max": -840.5341003864139, "episode_reward_min": -2224.999420273545, "episode_reward_mean": -1484.5564107741354, "episode_len_mean": 400.0, "episodes_this_iter": 66, "policy_reward_mean": {"av": -20.220054627814367}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 9.999999747378752e-06, "total_loss": 753.4044189453125, "policy_loss": 18.803823471069336, "vf_loss": 734.5985107421875, "vf_explained_var": 3.331899642944336e-05, "kl": 6.157209099910688e-06, "entropy": 1.4232553243637085}, "num_steps_trained": 154800, "num_steps_sampled": 154800, "sample_time_ms": 267454.71, "grad_time_ms": 17892.239, "update_time_ms": 29.059, "opt_peak_throughput": 1441.966, "sample_peak_throughput": 96.465, "opt_samples": 25800.0, "learner": {}}, "timesteps_this_iter": 25800, "done": false, "timesteps_total": 154800, "episodes_total": 387, "experiment_id": "675601f1efb241099ba7ab80b441289a", "date": "2019-10-10_17-03-10", "timestamp": 1570741390, "training_iteration": 6, "time_this_iter_s": 286.5859854221344, "time_total_s": 1712.8207113742828, "pid": 28214, "hostname": "node-050", "node_ip": "172.31.2.35", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"discrete\": false,\n            \"fraction_av\": 0.5,\n            \"inflow_base\": 803,\n            \"inflow_delta\": 20,\n            \"max_accel\": 3.5,\n            \"max_decel\": 5,\n            \"num_observed\": 2,\n            \"reset_inflow\": true,\n            \"speed_enter\": 30,\n            \"switch_time\": 3,\n            \"target_velocity\": 35,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiGridAVsPOEnv\",\n    \"exp_tag\": \"grid_av_0_1x1_i803_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"random\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 0,\n                \"cars_left\": 0,\n                \"cars_right\": 0,\n                \"cars_top\": 0,\n                \"col_num\": 1,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 1,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"traffic_lights\": false,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"followerstopper\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"followerstopper\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 3.5,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 3.5,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"followerstopper\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiGridAVsPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 3, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 25600, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(38,)", "Box(1,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x15183dab2908>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 1e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 1712.8207113742828, "timesteps_since_restore": 154800, "iterations_since_restore": 6}
{"episode_reward_max": -948.3833339145199, "episode_reward_min": -2725.067478158858, "episode_reward_mean": -1457.2302580820456, "episode_len_mean": 400.0, "episodes_this_iter": 63, "policy_reward_mean": {"av": -19.767095199159535}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 9.999999747378752e-06, "total_loss": 708.707275390625, "policy_loss": 18.109899520874023, "vf_loss": 690.5969848632812, "vf_explained_var": 4.2378902435302734e-05, "kl": 4.285746854293393e-06, "entropy": 1.4227098226547241}, "num_steps_trained": 180600, "num_steps_sampled": 180600, "sample_time_ms": 267981.188, "grad_time_ms": 17885.164, "update_time_ms": 26.365, "opt_peak_throughput": 1442.536, "sample_peak_throughput": 96.275, "opt_samples": 25800.0, "learner": {}}, "timesteps_this_iter": 25800, "done": false, "timesteps_total": 180600, "episodes_total": 450, "experiment_id": "675601f1efb241099ba7ab80b441289a", "date": "2019-10-10_17-07-59", "timestamp": 1570741679, "training_iteration": 7, "time_this_iter_s": 289.1156692504883, "time_total_s": 2001.9363806247711, "pid": 28214, "hostname": "node-050", "node_ip": "172.31.2.35", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"discrete\": false,\n            \"fraction_av\": 0.5,\n            \"inflow_base\": 803,\n            \"inflow_delta\": 20,\n            \"max_accel\": 3.5,\n            \"max_decel\": 5,\n            \"num_observed\": 2,\n            \"reset_inflow\": true,\n            \"speed_enter\": 30,\n            \"switch_time\": 3,\n            \"target_velocity\": 35,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiGridAVsPOEnv\",\n    \"exp_tag\": \"grid_av_0_1x1_i803_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"random\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 0,\n                \"cars_left\": 0,\n                \"cars_right\": 0,\n                \"cars_top\": 0,\n                \"col_num\": 1,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 1,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"traffic_lights\": false,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"followerstopper\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"followerstopper\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 3.5,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 3.5,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"followerstopper\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiGridAVsPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 3, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 25600, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(38,)", "Box(1,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x15183dab2390>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 1e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 2001.9363806247711, "timesteps_since_restore": 180600, "iterations_since_restore": 7}
{"episode_reward_max": -858.0892180227238, "episode_reward_min": -2764.185962775917, "episode_reward_mean": -1531.5927282890962, "episode_len_mean": 400.0, "episodes_this_iter": 66, "policy_reward_mean": {"av": -20.832327642669906}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 9.999999747378752e-06, "total_loss": 840.9530639648438, "policy_loss": 19.790939331054688, "vf_loss": 821.1602172851562, "vf_explained_var": 4.476308822631836e-05, "kl": 5.29272938365466e-06, "entropy": 1.4235466718673706}, "num_steps_trained": 206400, "num_steps_sampled": 206400, "sample_time_ms": 268815.763, "grad_time_ms": 17945.212, "update_time_ms": 23.618, "opt_peak_throughput": 1437.709, "sample_peak_throughput": 95.977, "opt_samples": 25800.0, "learner": {}}, "timesteps_this_iter": 25800, "done": false, "timesteps_total": 206400, "episodes_total": 516, "experiment_id": "675601f1efb241099ba7ab80b441289a", "date": "2019-10-10_17-12-52", "timestamp": 1570741972, "training_iteration": 8, "time_this_iter_s": 293.1803050041199, "time_total_s": 2295.116685628891, "pid": 28214, "hostname": "node-050", "node_ip": "172.31.2.35", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 400, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"add_rl_if_exit\": true,\n            \"discrete\": false,\n            \"fraction_av\": 0.5,\n            \"inflow_base\": 803,\n            \"inflow_delta\": 20,\n            \"max_accel\": 3.5,\n            \"max_decel\": 5,\n            \"num_observed\": 2,\n            \"reset_inflow\": true,\n            \"speed_enter\": 30,\n            \"switch_time\": 3,\n            \"target_velocity\": 35,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 400,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiGridAVsPOEnv\",\n    \"exp_tag\": \"grid_av_0_1x1_i803_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"random\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 0,\n                \"cars_left\": 0,\n                \"cars_right\": 0,\n                \"cars_top\": 0,\n                \"col_num\": 1,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 1,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 35,\n            \"traffic_lights\": false,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"left1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"followerstopper\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 30,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 401.5,\n                    \"vtype\": \"followerstopper\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 3.5,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 3.5,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"followerstopper\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MultiGridAVsPOEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 3, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 25600, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(38,)", "Box(1,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x15183dab2e80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 1e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 2295.116685628891, "timesteps_since_restore": 206400, "iterations_since_restore": 8}
